(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{8312:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return n(3069)}])},3069:function(e,t,n){"use strict";n.r(t),n.d(t,{SourceCodeDisplay:function(){return SourceCodeDisplay},default:function(){return Home}});var r=n(5893),o=n(7294),a=n(6525);function traceCustomRenderer(e,...t){["createTextInstance","appendInitialChild"].includes(e)&&console.log(`[CustomRenderer] ${e}`,...t)}let l=a({createInstance:(e,t,n)=>(traceCustomRenderer("createInstance",e,t,n),{type:e,props:t,children:[],nodeType:"element"}),createTextInstance:(e,t)=>(traceCustomRenderer("createTextInstance",e,t),{value:e,nodeType:"text"}),appendInitialChild(e,t){var n;traceCustomRenderer("appendInitialChild",e,t),null===(n=e.children)||void 0===n||n.push(t)},finalizeInitialChildren:(e,t,n)=>(traceCustomRenderer("finalizeInitialChildren",e,t,n),!1),shouldSetTextContent:(e,t,n)=>(traceCustomRenderer("shouldSetTextContent",e,t,n),!1),preparePortalMount(e,t){traceCustomRenderer("preparePortalMount",e,t)},getRootHostContext:()=>null,getChildHostContext:(e,t,n)=>e,prepareForCommit:()=>null,resetAfterCommit(){},getPublicInstance:e=>e,prepareUpdate:(e,t,n,r,o)=>({type:t,props:r}),commitUpdate(e,t,n,r,o,a){e.type=n,e.props=o},commitTextUpdate(e,t,n){e.value=n},commitMount(e,t,n,r){},resetTextContent(e){console.log("resetTextContent",e)},getInstanceFromNode:e=>e,getNodeFromInstance:e=>e,isPrimaryRenderer:!1,supportsHydration:!1,scheduleTimeout:(e,t)=>setTimeout(e,t),cancelTimeout(e){clearTimeout(e)},noTimeout:-1,now:()=>Date.now(),supportsMicrotasks:!0,scheduleMicrotask(e){queueMicrotask(e)},supportsMutation:!1,supportsPersistence:!0,getCurrentEventPriority:()=>0,createContainerChildSet(e){return traceCustomRenderer("createContainerChildSet",arguments),e},replaceContainerChildren(e,t){return traceCustomRenderer("replaceContainerChildren",arguments),t},appendChildToContainerChildSet(e,t){var n;traceCustomRenderer("appendChildToContainerChildSet",arguments),null===(n=e.children)||void 0===n||n.push(t)},finalizeContainerChildren:e=>!1});function dropUndefinedValues(e){return Object.fromEntries(Object.entries(e).filter(([e,t])=>void 0!==t))}function processCell(e){return{...processCellContents(e),...dropUndefinedValues({width:e.props.width,z:e.props.z})}}function processCellContents(e){var t,n;let r=null===(n=null===(t=e.children)||void 0===t?void 0:t.filter(e=>"text"===e.nodeType))||void 0===n?void 0:n.map(e=>e.value).join("");if("boolean"===e.type&&"boolean"==typeof e.props.children&&(r=e.props.children.toString()),console.log("Rendering cell",e.type,r,e.children),"element"===e.nodeType&&"text"===e.type)return{t:"s",v:r};if("element"===e.nodeType&&"number"===e.type)return{t:"n",v:Number(r)};if("element"===e.nodeType&&"boolean"===e.type)return"true"===r||"1"===r?{t:"b",v:!0}:("false"===r||"0"===r||console.warn(`Invalid boolean value ${r}`),{t:"b",v:!1});if("element"===e.nodeType&&"date"===e.type)return{t:"n",v:convertToExcelDate(new Date(r)),z:"YYYY-MM-DD"};if("element"===e.nodeType&&"formula"===e.type)return{f:r};throw Error("Unsupported cell type")}function processTopLevelElements(e){if("row"===e.type){let t={cells:[],widthSetting:e.props.widthSetting||!1};if(e.children)for(let n of e.children){if("text"===n.nodeType){if(n.value.trim())throw Error("Non-empty text node found in row");continue}let e=processCell(n);e&&t.cells.push(e)}return t}return null}function convertToExcelSheet(e){let t={rows:[]};if(e.children)for(let n of e.children){if("element"!==n.nodeType)throw Error(`Non-element node with value ${n.value} found in top level`);let e=processTopLevelElements(n);e&&t.rows.push(e)}return t}function convertToExcelDate(e){if(isNaN(e.getTime()))throw Error(`Invalid date ${e}`);let t=new Date("1899-12-31T00:00:00Z"),n=new Date("1900-03-01T00:00:00Z"),r=e.getTime()>n.getTime()?864e5:0;return(e.getTime()-t.getTime()+r)/864e5}let i=(0,o.createContext)(null),s={didCatch:!1,error:null};let ErrorBoundary=class ErrorBoundary extends o.Component{constructor(e){super(e),this.resetErrorBoundary=this.resetErrorBoundary.bind(this),this.state=s}static getDerivedStateFromError(e){return{didCatch:!0,error:e}}resetErrorBoundary(){let{error:e}=this.state;if(null!==e){for(var t,n,r=arguments.length,o=Array(r),a=0;a<r;a++)o[a]=arguments[a];null===(t=(n=this.props).onReset)||void 0===t||t.call(n,{args:o,reason:"imperative-api"}),this.setState(s)}}componentDidCatch(e,t){var n,r;null===(n=(r=this.props).onError)||void 0===n||n.call(r,e,t)}componentDidUpdate(e,t){let{didCatch:n}=this.state,{resetKeys:r}=this.props;if(n&&null!==t.error&&hasArrayChanged(e.resetKeys,r)){var o,a;null===(o=(a=this.props).onReset)||void 0===o||o.call(a,{next:r,prev:e.resetKeys,reason:"keys"}),this.setState(s)}}render(){let{children:e,fallbackRender:t,FallbackComponent:n,fallback:r}=this.props,{didCatch:a,error:l}=this.state,s=e;if(a){let e={error:l,resetErrorBoundary:this.resetErrorBoundary};if("function"==typeof t)s=t(e);else if(n)s=(0,o.createElement)(n,e);else if(void 0!==r)s=r;else throw l}return(0,o.createElement)(i.Provider,{value:{didCatch:a,error:l,resetErrorBoundary:this.resetErrorBoundary}},s)}};function hasArrayChanged(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return e.length!==t.length||e.some((e,n)=>!Object.is(e,t[n]))}let c=(0,o.forwardRef)(({children:e},t)=>{(0,o.useImperativeHandle)(t,()=>({getExcelSheet:async()=>{let t={nodeType:"root",children:[]},n=l.createContainer(t,0,null,!1,null,"",e=>{console.error("ERROR OCCURRED",e)},null);return new Promise((o,a)=>{console.log("getExcelSheet -- updateContainer -- start"),l.updateContainer((0,r.jsx)(ErrorBoundary,{fallbackRender:({error:e})=>{throw a(e),e},children:e}),n,null,()=>{console.log("getExcelSheet -- updateContainer -- callback"),o(convertToSheetJSFormat(convertToExcelSheet(t)))})})}}),[]);let convertToSheetJSFormat=e=>{let t={},n={s:{r:0,c:0},e:{r:0,c:0}};e.rows.forEach((e,r)=>{e.cells.forEach((e,o)=>{let a=getCellRef(r,o),l={v:e.v,t:e.t,f:e.f,z:e.z};t[a]=Object.fromEntries(Object.entries(l).filter(([e,t])=>void 0!==t)),n.e.r=Math.max(n.e.r,r),n.e.c=Math.max(n.e.c,o)})});let r=e.rows.find(e=>e.widthSetting);return r&&(t["!cols"]=r.cells.map(e=>({width:e.width||10}))),t["!ref"]=getCellRef(n.s.r,n.s.c)+":"+getCellRef(n.e.r,n.e.c),t},getCellRef=(e,t)=>{let n=String.fromCharCode(65+t);return n+(e+1)};return null});var d=n(6612),h=n.n(d),u=n(4105);let p=[{name:"John Doe",age:30,salary:75e3,active:!0,startDate:"2020-01-15"},{name:"Jane Smith",age:28,salary:65e3,active:!0,startDate:"2019-03-20"},{name:"Bob Johnson",age:35,salary:85e3,active:!1,startDate:"2018-11-10"},{name:"Alice Brown",age:26,salary:6e4,active:!0,startDate:"2021-06-05"}],ExcelTable=()=>{let e=(0,o.useRef)(null);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(c,{ref:e,children:[(0,r.jsxs)("row",{widthSetting:!0,children:[(0,r.jsx)("text",{width:15,children:"Name"}),(0,r.jsx)("text",{width:8,children:"Age"}),(0,r.jsx)("text",{width:12,children:"Salary"}),(0,r.jsx)("text",{width:8,children:"Active"}),(0,r.jsx)("text",{width:12,children:"Start Date"})]}),p.map((e,t)=>(0,r.jsxs)("row",{children:[(0,r.jsx)("text",{children:e.name}),(0,r.jsx)("number",{children:e.age}),(0,r.jsx)("number",{z:"$#,##0",children:e.salary}),(0,r.jsx)("boolean",{children:e.active}),(0,r.jsx)("date",{z:"MMM dd, yyyy",children:e.startDate})]},t))]}),(0,r.jsx)("button",{className:h().exportButton,onClick:()=>downloadSheet(e.current),children:"Download as Excel"})]})};function HTMLTable(){return(0,r.jsxs)("table",{className:h().table,children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{children:"Name"}),(0,r.jsx)("th",{children:"Age"}),(0,r.jsx)("th",{children:"Salary"}),(0,r.jsx)("th",{children:"Active"}),(0,r.jsx)("th",{children:"Start Date"})]})}),(0,r.jsx)("tbody",{children:p.map((e,t)=>(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{children:e.name}),(0,r.jsx)("td",{children:e.age}),(0,r.jsxs)("td",{children:["$",e.salary.toLocaleString()]}),(0,r.jsx)("td",{children:e.active?"Yes":"No"}),(0,r.jsx)("td",{children:new Date(e.startDate).toLocaleDateString()})]},t))})]})}function downloadBlobAsMimeType(e,t){let n=URL.createObjectURL(e),r=document.createElement("a");r.href=n,r.download="sheet.xlsx",r.click()}async function downloadSheet(e){let t=await e.getExcelSheet(),n=u.op({SheetNames:["Sheet1"],Sheets:{Sheet1:t}},{bookType:"xlsx",type:"buffer"}),r=new Blob([n],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});downloadBlobAsMimeType(r,"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet")}var m=n(5152),x=n.n(m),f=n(5660),y=n.n(f);function hideLines(e){let t=e.split("\n"),n=!1,r=[];for(let e of t){if(n){n=!1;continue}if(e.startsWith("// source-hide-next-line")){n=!0;continue}r.push(e)}return r.join("\n")}function SourceCodeDisplay(){let e=hideLines("import { SheetJsOutput } from 'react-export-sheetjs';\nimport type { SheetJsOutputRef } from 'react-export-sheetjs';\nimport { useRef } from 'react';\n// source-hide-next-line\nimport styles from './styles/Home.module.css';\nimport * as XLSX from 'xlsx';\n\nconst sampleData = [\n  { name: 'John Doe', age: 30, salary: 75000, active: true, startDate: '2020-01-15' },\n  { name: 'Jane Smith', age: 28, salary: 65000, active: true, startDate: '2019-03-20' },\n  { name: 'Bob Johnson', age: 35, salary: 85000, active: false, startDate: '2018-11-10' },\n  { name: 'Alice Brown', age: 26, salary: 60000, active: true, startDate: '2021-06-05' },\n];\n\nexport const ExcelTable = () => {\n  const ref = useRef<SheetJsOutputRef>(null);\n  return (\n    <>\n      <SheetJsOutput ref={ref}>\n        <row widthSetting={true}>\n          <text width={15}>Name</text>\n          <text width={8}>Age</text>\n          <text width={12}>Salary</text>\n          <text width={8}>Active</text>\n          <text width={12}>Start Date</text>\n        </row>\n\n        {sampleData.map((employee, index) => (\n          <row key={index}>\n            <text>{employee.name}</text>\n            <number>{employee.age}</number>\n            <number z=\"$#,##0\">{employee.salary}</number>\n            <boolean>{employee.active}</boolean>\n            <date z=\"MMM dd, yyyy\">{employee.startDate}</date>\n          </row>\n        ))}\n      </SheetJsOutput>\n      <button className={styles.exportButton} onClick={() => downloadSheet(ref.current)}>\n        Download as Excel\n      </button>\n    </>\n  );\n};\n\nexport function HTMLTable() {\n  return (\n    <table className={styles.table}>\n      <thead>\n        <tr>\n          <th>Name</th>\n          <th>Age</th>\n          <th>Salary</th>\n          <th>Active</th>\n          <th>Start Date</th>\n        </tr>\n      </thead>\n      <tbody>\n        {sampleData.map((employee, index) => (\n          <tr key={index}>\n            <td>{employee.name}</td>\n            <td>{employee.age}</td>\n            <td>${employee.salary.toLocaleString()}</td>\n            <td>{employee.active ? 'Yes' : 'No'}</td>\n            <td>{new Date(employee.startDate).toLocaleDateString()}</td>\n          </tr>\n        ))}\n      </tbody>\n    </table>\n  );\n}\n\nfunction downloadBlobAsMimeType(blob: Blob, mimeType: string) {\n  const url = URL.createObjectURL(blob);\n  const a = document.createElement('a');\n  a.href = url;\n  a.download = 'sheet.xlsx';\n  a.click();\n}\n\nasync function downloadSheet(ref: SheetJsOutputRef) {\n  const worksheet = await ref.getExcelSheet();\n  const workbook = {\n    SheetNames: ['Sheet1'],\n    Sheets: {\n      Sheet1: worksheet,\n    },\n  };\n  const fileData = XLSX.writeXLSX(workbook, {\n    bookType: 'xlsx',\n    type: 'buffer',\n  });\n\n  const blob = new Blob([fileData], {\n    type: 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet',\n  });\n\n  downloadBlobAsMimeType(blob, 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet');\n}\n");return(0,o.useEffect)(()=>{y().highlightAll()},[e]),(0,r.jsx)("div",{children:(0,r.jsx)("pre",{className:"language-jsx",children:(0,r.jsx)("code",{className:"language-jsx",children:e})})})}function HomeComponent(){return(0,r.jsxs)("div",{className:h().container,children:[(0,r.jsxs)("main",{className:h().main,children:[(0,r.jsx)("h1",{className:h().title,children:"React Export Excel Demo"}),(0,r.jsx)("p",{className:h().description,children:"A Next.js example showing how to use the react-export-excel library"}),(0,r.jsxs)("div",{className:h().demoSection,children:[(0,r.jsx)("h2",{children:"Live Demo"}),(0,r.jsx)("p",{children:"Click the button below to export the sample data to Excel:"}),(0,r.jsx)(HTMLTable,{}),(0,r.jsx)(ExcelTable,{})]}),(0,r.jsxs)("div",{className:h().codeSection,children:[(0,r.jsx)("h2",{children:"Source Code"}),(0,r.jsx)("p",{children:"Here's how to implement this in your own project:"}),(0,r.jsx)(SourceCodeDisplay,{})]})]}),(0,r.jsx)("footer",{className:h().footer,children:(0,r.jsx)("a",{href:"https://github.com/xkjyeah/react-export-excel",target:"_blank",rel:"noopener noreferrer",children:"View on GitHub"})})]})}function Home(){let e=x()(()=>Promise.resolve(HomeComponent),{ssr:!1});return(0,r.jsx)(e,{})}n(2356),n(6836),n(1819)},6612:function(e){e.exports={container:"Home_container__d256j",main:"Home_main__VkIEL",footer:"Home_footer__yFiaX",title:"Home_title__hYX6j",description:"Home_description__uXNdx",demoSection:"Home_demoSection__6iynW",previewSection:"Home_previewSection__ZBhwS",codeSection:"Home_codeSection__D8aRL",featuresSection:"Home_featuresSection__9MiUa",exportButton:"Home_exportButton__AfYi5",tableContainer:"Home_tableContainer___I4bz",table:"Home_table__mY_9K",codeBlock:"Home_codeBlock__QjgQa",featuresList:"Home_featuresList__X4reI",grid:"Home_grid__AVljO"}},67:function(){},2061:function(){}},function(e){e.O(0,[251,561,774,888,179],function(){return e(e.s=8312)}),_N_E=e.O()}]);